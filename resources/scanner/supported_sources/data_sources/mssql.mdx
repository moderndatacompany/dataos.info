---
title: "Scanner for MSSQL"
---

Metadata can be extracted from MSSQL using below given requirements and sample manifest configurations.

## **Requirements**

* Credentials to connect to MSSQL database.

* To extract metadata, the MSSQL user needs to have access to the `INFORMATION_SCHEMA`.

* MSSQL User must grant `SELECT` privilege to fetch the metadata of tables and views.

* **Access Permission to Run a Scanner Workflow**
  Verify that the use case or role tag for executing a Scanner Workflow is approved, which are as follows:

| **Access using Role Tag** | **Access using Use cases**     |
| ------------------------- | ------------------------------ |
| `roles:id:data-dev`       | Read Workspace                 |
| `roles:id:system-dev`     | Run as Scanner User            |
| `roles:id:user`           | Manage All Depot               |
|                           | Read All Dataset               |
|                           | Read all secrets from Heimdall |

* Ensure an JDBC-type Depot is created by in Metis UI or in CLI as shown below:
  ```bash
  dataos-ctl get -t depot -a
  ```
  If not, create it using the following sample manifest code:

  ```yaml
  name: ${{depot-name}}   #examples: mssqldepot, depotms, mssql01 etc.
  version: v2alpha
  type: depot
  tags:
    - ${{tag1}}
  owner: ${{owner-name}}
  layer: user
  depot:
    type: JDBC                                      
    description: ${{description}}
    external: ${{true}}
    secrets:
      - name: ${{sf-instance-secret-name}}-r
        allkeys: true

      - name: ${{sf-instance-secret-name}}-rw
        allkeys: true
    jdbc:                                           
      subprotocol: ${{subprotocol}}
      host: ${{host}}
      port: ${{port}}
      database: ${{database-name}}
      params:
        ${{"key1": "value1"}}
        ${{"key2": "value2"}}
  ```

## **Scanner Workflow**

DataOS allows to connect and scan metadata from an MSSQL-type Depot with Scanner workflows. The Depot enables access to all schemas visible to the specified user in the configured database, MSSQL.

<Info>
  Ensure that the Depot is created for your MSSQL database and you have `Read` access for the Depot.
</Info>

```yaml
version: v1
name: mssql-scanner2
type: workflow
tags:
  - mssql-scanner2.0
description: The job scans schema tables and register metadata
workflow:
  dag:
    - name: scanner2-mssql
      description: The job scans schema from Mssql depot tables and register metadata to metis2
      spec:
        stack: scanner:2.0
        compute: runnable-default
        runAsUser: metis
        stackSpec:
          depot: mssql01
          sourceConfig:
            config:
              markDeletedTables: false
              includeTables: true
              includeViews: true
              databaseFilterPattern:
                  includes:
                      - database1
                      - database2
                    excludes:
                      - database3
                      - database4
                  schemaFilterPattern:
                    includes:
                      - schema1
                      - schema2
                    excludes:
                      - schema3
                      - schema4
                  tableFilterPattern:
                    includes:
                      - table1
                      - table2
                    excludes:
                      - table3
                      - table4
```

After the successful Workflow run, user can check the metadata of scanned Tables on Metis UI for all schemas present in the database. The above sample manifest file is deployed using the following command:

```
dataos-ctl resource apply -f {path to the Scanner YAML}
```

<Note>
  If the Depot or Scanner configurations are updated, the Scanner must be redeployed after deleting the previous instance. Use the following command to delete the existing Scanner:

  ```
  dataos-ctl resource delete -f {path to the Scanner YAML file}
  ```
</Note>