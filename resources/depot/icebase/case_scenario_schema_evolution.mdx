---
title: "Case Scenario: Schema Evolution"
---

## Procedure

* Apply the command which you want to execute

* To observe the changes within the Workbench, execute the below command

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-0-1)`dataos-ctl dataset -a ${{udl}} set-metadata \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-0-2)`-v `latest


**Dataset**Â -Â `dataos://icebase:retail/city`

## Add Field/Column

The following command can be used to add a column to the table or a nested struct.

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-1-1)`dataos-ctl dataset -a dataos://icebase:retail/city add-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-1-2)`-n ${{column-name}} \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-1-3)`-t ${{column-datatype}}`


Only the following column data types are supported

Data typeDescriptionRequirements

boolean

True or false

int

32-bit signed integers

Can promote toÂ long

long

32-bit signed integers

float

32-bit IEEE 754Â floating point

Can promote to double

double

64-bit IEEE 754Â floating point

decimal

Fixed-point decimal; precision P, scale S

Scale is fixed, \[1], precision must be 38 or less

date

Calendar date without timezone or time

time

Time of day without date, timezone

Microsecond precision

timestamp

Timestamp without timezone

Microsecond precision \[2]

timestamptz

Timestamp with timezone

Stored as UTC \[2]

string

Arbitrary-length character sequences

Encoded with UTF-8 \[3]

uuid

Universally unique identifiers

Should use 16-byte fixed

fixed(L)

Fixed-length byte array of length L

binary

Arbitrary-length byte array

Initial Schema observed in Workbench

![case\_scenario\_schema\_evolution](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/1.png)

Let's add a new column calledÂ `new1`Â into the city dataset with a typeÂ `string`. Execute the following code in the terminal.

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-2-1)`dataos-ctl dataset -a dataos://icebase:retail/city add-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-2-2)`-n new1 \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-2-3)`-t `string


Output (on successful execution of code)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-3-1)`INFO[0000] ðŸ“‚ add field...                               `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-3-2)`INFO[0001] ðŸ“‚ add `field...completed


To observe the changes made to the initial dataset, execute the following code

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-4-1)`dataos-ctl dataset -a dataos://icebase:retail/city set-metadata \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-4-2)`-v `latest


Output (on successful execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-5-1)`INFO[0000] ðŸ“‚ set metadata...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-5-2)`INFO[0001] ðŸ“‚ set `metadata...completed


Observe the change in the workbench; a new field by the nameÂ `new1`Â is added

![Schema Evolution 2](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/2.png)

## Drop Field/Column[Â¶](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#drop-fieldcolumn "Permanent link")

To remove an existing column from the table or a nested struct, the following command can be executed

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-6-1)`dataos-ctl dataset -a dataos://icebase:retail/city drop-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-6-2)`-n ${{column-name}}`


![Schema Evolution 3](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/3.png)

Letâ€™s remove columnÂ `new1`Â from the city dataset. Execute the following code in the terminal

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-7-1)`dataos-ctl dataset -a dataos://icebase:retail/city drop-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-7-2)`-n `new1


Output (on successful execution of code)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-8-1)`INFO[0000] ðŸ“‚ remove field...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-8-2)`INFO[0001] ðŸ“‚ remove `field...completed


To observe the changes made to the initial dataset, execute the following code

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-9-1)`dataos-ctl dataset -a dataos://icebase:retail/city set-metadata \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-9-2)`-v `latest


Output (on successful execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-10-1)`INFO[0000] ðŸ“‚ set metadata...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-10-2)`INFO[0001] ðŸ“‚ set `metadata...completed


Observe the change in the workbench; theÂ `new1`Â column is removed

![Schema Evolution 1](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/1.png)

## Rename Field/Column[Â¶](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#rename-fieldcolumn "Permanent link")

To rename an existing column or field in a nested struct, execute the below code

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-11-1)`dataos-ctl dataset -a dataos://icebase:retail/city rename-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-11-2)`-n ${{column-name}} \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-11-3)`-m ${{column-new-name}}`


Letâ€™s rename the columnÂ `city_name`Â in the city dataset toÂ `name`. For this following code needs to be executed -

![Schema Evolution 5](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/4.png)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-12-1)`dataos-ctl dataset -a dataos://icebase:retail/city rename-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-12-2)`-n city_name \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-12-3)`-m `name


Output (on successful code execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-13-1)`INFO[0000] ðŸ“‚ rename field...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-13-2)`INFO[0001] ðŸ“‚ rename `field...completed


To observe the renamed column in the workbench, run the set-metadata command

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-14-1)`dataos-ctl dataset -a dataos://icebase:retail/city set-metadata \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-14-2)`-v `latest


Output (on successful execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-15-1)`INFO[0000] ðŸ“‚ set metadata...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-15-2)`INFO[0001] ðŸ“‚ set `metadata...completed


TheÂ `city_name`Â column is renamed toÂ `name`. As observed below

![Schema Evolution 6](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/6.png)

## UpdateÂ Field/Column[Â¶](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#update-fieldcolumn "Permanent link")

To widen the type of a column, struct field, map key, map value, or list element, the below command can be executed

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-16-1)`dataos-ctl dataset -a dataos://icebase:retail/city update-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-16-2)`-n ${{column-name}} \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-16-3)`-t ${{column-datatype}}`


> ðŸ—£ Updating columnÂ [type](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/)Â is limited to only certain data types for any particular type -Â `integer`Â toÂ `long`Â -Â `float`Â toÂ `double`Â - Increasing the precision ofÂ `decimal`Â type

![Schema Evolution 1](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/1.png)

Letâ€™s update theÂ `zip_code`Â column type fromÂ `INTEGER (integer)`Â toÂ `BIGINT (long)`. The code is as follows -

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-17-1)`dataos-ctl dataset -a dataos://icebase:retail/city update-field \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-17-2)`-n zip_code \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-17-3)`-t `long


Output(successful execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-18-1)`INFO[0000] ðŸ“‚ update field datatype...                   `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-18-2)`INFO[0001] ðŸ“‚ update field `datatype...completed


To observe the changes in the workbench, execute the set-metadata command as follows -

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-19-1)`dataos-ctl dataset -a dataos://icebase:retail/city set-metadata \`
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-19-2)`-v `latest


Output (on successful execution)

[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-20-1)`INFO[0000] ðŸ“‚ set metadata...                            `
[](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/#__codelineno-20-2)`INFO[0001] ðŸ“‚ set `metadata...completed


The type ofÂ `zip_code`Â is changed fromÂ `INTEGER (integer)`Â toÂ `BIGINT (long)`

![Schema Evolution 8](https://dataos.info/resources/depot/icebase/case_scenario_schema_evolution/8.png)